<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dlim">
<title>Distributed Lag Interaction Model Overview • dlim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Distributed Lag Interaction Model Overview">
<meta property="og:description" content="dlim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dlim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dlimOverview.html">Distributed Lag Interaction Model Overview</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ddemateis/dlim/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Distributed Lag Interaction Model Overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ddemateis/dlim/blob/HEAD/vignettes/dlimOverview.Rmd" class="external-link"><code>vignettes/dlimOverview.Rmd</code></a></small>
      <div class="d-none name"><code>dlimOverview.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="preamble">Preamble<a class="anchor" aria-label="anchor" href="#preamble"></a>
</h2>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The latest version of this package on GitHub can be downloaded and
installed by</p>
<p><code>install_github("ddemateis/dlim")</code></p>
<p>or on CRAN by</p>
<p><code>install.packages("dlim")</code></p>
<p>Then the package can be loaded by</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ddemateis.github.io/dlim/">dlim</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is dlim 0.1.0. For details: help(`dlim-package`) and vignette('dlimOverview').</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="methodology-and-applications">Methodology and Applications<a class="anchor" aria-label="anchor" href="#methodology-and-applications"></a>
</h2>
<p>See <a href="https://doi.org/10.1002/env.2843" class="external-link">Demateis et
al. 2024</a> for details on methodology and applications.</p>
</div>
<div class="section level2">
<h2 id="functions-in-the-package">Functions in the package<a class="anchor" aria-label="anchor" href="#functions-in-the-package"></a>
</h2>
<div class="section level3">
<h3 id="the-function-dlim">The function <code>dlim()</code><a class="anchor" aria-label="anchor" href="#the-function-dlim"></a>
</h3>
<p>To fit a DLIM using this package, first use the <code><a href="../reference/dlim.html">dlim()</a></code>
function, which creates a cross-basis using the
<code><a href="../reference/cross_basis.html">cross_basis()</a></code> function and then fits a GAM using using the
cross-basis. <code><a href="../reference/dlim.html">dlim()</a></code> takes a vector of response values,
<code>y</code>, a matrix of exposure history, <code>x</code>, the
modifier variable, <code>modifier</code>, and a matrix of other
covariates, <code>z</code>. Do not include the modifier in
<code>z</code>, as <code><a href="../reference/dlim.html">dlim()</a></code> will add the modifier to the
covariate matrix later in the function. You will also need to specify
the degrees of freedom for the modifier basis, <code>df_m</code>, and
the exposure time basis, <code>df_l</code>. You can optionally specify
whether to penalize, <code>penalize = T</code> or
<code>penalize = F</code>, though the function will default to
<code>penalize = T</code>. We recommend specifying
<code>method = "REML"</code> if penalizing. If the data set is very
large, you can set <code>fit_fn = "bam"</code> so <code><a href="../reference/dlim.html">dlim()</a></code>
uses <code>bam()</code> instead of <code>gam()</code> for model fitting.
See <code>?bam</code> for more details.</p>
</div>
<div class="section level3">
<h3 id="the-function-predict">The function <code>predict()</code><a class="anchor" aria-label="anchor" href="#the-function-predict"></a>
</h3>
<p>After using the <code><a href="../reference/dlim.html">dlim()</a></code> function to fit a DLIM, you can
use <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> to make predictions with confidence intervals
for any set of modifying values. <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> is an S3 method
for objects of class <code>dlim</code> which takes an object of class
<code>dlim</code>, <code>object</code>, and the type of prediction,
<code>type = "DLF"</code> to predict the distributed lag function or
point-wise effects for a set of modifier, <code>type = "CE"</code> to
predict the cumulative effects for a set of modifiers, or
<code>type = c("CE", "DLF")</code> to predict both the distributed lag
function and cumulative effect. You can pass a new vector of modifier
values to <code>newdata</code>. If left as <code>NULL</code>, then
prediction will be on the original modifier values. The confidence level
can be changed using <code>alpha</code>.</p>
</div>
<div class="section level3">
<h3 id="the-function-plot_cumulative">The function <code>plot_cumulative()</code><a class="anchor" aria-label="anchor" href="#the-function-plot_cumulative"></a>
</h3>
<p>After using the <code><a href="../reference/dlim.html">dlim()</a></code> function to fit a DLIM, you can
use the <code><a href="../reference/plot_cumulative.html">plot_cumulative()</a></code> function to plot the cumulative
effects and confidence regions for any set of modifying values.
<code><a href="../reference/plot_cumulative.html">plot_cumulative()</a></code> takes a vector of modifying values,
<code>new_modifiers</code>, and an object of class <code>dlim</code>,
<code>mod_fit</code>. Optionally, you can provide the name of the
modifier for the plot axis label, <code>mod_name</code>, and a
back-transformation function to <code>mod_trans</code> if the specified
modifier values have been transformed. This function also have the
ability to compare a DLM fit to a DLIM fit. If the <code>dlm_fit</code>
argument is passed a list containing a <code>crossbasis</code> object
from the <code>dlnm</code> package and a fitted DLM model object, then
the plot will also include the estimated cumulative effects and
confidence region for the same modifying values for the DLM. If the
model family is not Gaussian, specify a transformation function using
<code>link_trans</code>.</p>
</div>
<div class="section level3">
<h3 id="the-function-plot_dlf">The function <code>plot_DLF()</code><a class="anchor" aria-label="anchor" href="#the-function-plot_dlf"></a>
</h3>
<p>After using the <code><a href="../reference/dlim.html">dlim()</a></code> function to fit a DLIM, you can
use the <code><a href="../reference/plot_DLF.html">plot_DLF()</a></code> function to create a grid of plots for
the estimated point-wise effects (i.e. estimated distributed lag
function) and confidence regions for any set of modifying values.
<code><a href="../reference/plot_DLF.html">plot_DLF()</a></code> takes a vector of modifying values,
<code>new_modifiers</code>, an object of class <code>dlim</code>,
<code>mod_fit</code>, and whether to create a grid of plots by modifier
value, <code>plot_by = "modifier"</code>, or by particular time points,
<code>plot_by = "time"</code>. If you are want each plot in the grid to
be for a time point, you must pass <code>time_pts</code> a vector of
time points. Optionally, you can provide the name of the modifier for
the plot axis label, <code>mod_name</code>, and a back-transformation
function if the specified modifier values have been transformed. This
function also have the ability to compare a DLM fit to a DLIM fit. If
the <code>dlm_fit</code> argument is passed a list containing a
<code>crossbasis</code> object from the <code>dlnm</code> package and a
fitted DLM model object, then the plot will also include the estimated
cumulative effects and confidence region for the same modifying values
for the DLM. If the model family is not Gaussian, specify a
transformation function using <code>link_trans</code>.</p>
</div>
<div class="section level3">
<h3 id="the-function-model_comparison">The function <code>model_comparison()</code><a class="anchor" aria-label="anchor" href="#the-function-model_comparison"></a>
</h3>
<p>You can use the <code>model_comparison</code> function to compare
models with and without interaction, or models of varying levels of
interaction. See <a href="https://doi.org/10.1002/env.2843" class="external-link">Demateis et
al. 2024</a> for discussion. The <code>model_comparison</code> function
takes a <code>dlim</code> object (must be fit with REML) through the
<code>fit</code> argument. The fit object is the full model. Specify the
null model, either <code>null = "DLM"</code> or
<code>null = "linear"</code> are currently supported. <code>x</code> is
the exposure matrix used to fit <code>fit</code>, <code>B</code> is the
number of bootstrap samples, and <code>conf.level</code> is the
confidence level with default 0.95. The function returns a decision to
reject or fail to reject based on the confidence level.</p>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Using the example data set in the package, fit a DLIM using the
<code><a href="../reference/dlim.html">dlim()</a></code> function. First load the data set:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ex_data"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">ex_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ y       : num [1:1000, 1] 21.4 25.4 22.7 27.2 23.5 ...</span></span>
<span><span class="co">#&gt;  $ exposure:Classes 'data.table' and 'data.frame':   1000 obs. of  37 variables:</span></span>
<span><span class="co">#&gt;   ..$ PM25_1 : num [1:1000] 11.07 4.84 12.58 14.68 11.36 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_2 : num [1:1000] 13.15 5.85 14.35 16.41 9.4 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_3 : num [1:1000] 11.17 5.9 20.8 18.95 8.62 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_4 : num [1:1000] 7.56 5.36 14.85 11.54 6.67 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_5 : num [1:1000] 22.71 5.28 10.67 8.23 9.31 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_6 : num [1:1000] 11.4 5.62 9.44 16.92 7.47 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_7 : num [1:1000] 7.56 6.98 16.63 7.9 10.18 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_8 : num [1:1000] 8.74 5.41 7.37 12.55 10.77 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_9 : num [1:1000] 11.03 6.02 13.76 10.69 10.91 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_10: num [1:1000] 7.01 6.83 10 6.38 10.38 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_11: num [1:1000] 8.45 9.88 6.43 7.84 8.11 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_12: num [1:1000] 6.51 8.76 7.74 9.32 10.43 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_13: num [1:1000] 10.21 9.4 9.25 10.92 6.96 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_14: num [1:1000] 6.23 9.04 10.99 6.77 8.7 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_15: num [1:1000] 7.69 9.94 7.29 6.73 10.18 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_16: num [1:1000] 9.8 10.36 6.7 9.97 13.58 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_17: num [1:1000] 8.4 10.87 10.29 7.69 12.29 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_18: num [1:1000] 7.12 7.8 7.17 7.48 14.43 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_19: num [1:1000] 7.26 11.51 7.33 6.51 13.51 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_20: num [1:1000] 8.71 9.42 7.01 11.32 10.4 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_21: num [1:1000] 6.63 7.6 11.68 8.16 9.01 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_22: num [1:1000] 10.48 10.42 7.17 5.55 9.79 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_23: num [1:1000] 9.16 11.35 6.39 12.78 8.78 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_24: num [1:1000] 11.65 8.91 14.66 14.39 12.97 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_25: num [1:1000] 13.86 11.61 11.68 9.42 7.31 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_26: num [1:1000] 6.84 6.57 10.32 9.14 4.9 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_27: num [1:1000] 12.68 7.59 9.3 14.54 8.29 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_28: num [1:1000] 8.83 8.7 15.13 11.79 7.29 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_29: num [1:1000] 9.09 6.27 11.55 11.31 10.24 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_30: num [1:1000] 11.12 8.83 11.69 12.86 6.72 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_31: num [1:1000] 8.34 7.71 11.14 9.23 7.81 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_32: num [1:1000] 7.58 8.8 11.96 14.72 8.03 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_33: num [1:1000] 10.08 7.18 11.98 13.78 7.02 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_34: num [1:1000] 11.88 9.19 14.53 13.28 7.86 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_35: num [1:1000] 7.14 5.94 13.38 8.76 8.23 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_36: num [1:1000] 7 6 7.88 11.14 7.75 ...</span></span>
<span><span class="co">#&gt;   ..$ PM25_37: num [1:1000] 7.22 8.13 13.02 19.72 11.41 ...</span></span>
<span><span class="co">#&gt;  $ modifier: num [1:1000] 0.141 0.605 0.375 0.703 0.833 ...</span></span>
<span><span class="co">#&gt;  $ z       : num [1:1000, 1:3] -1.462 -0.44 0.941 0.969 1.708 ...</span></span></code></pre></div>
<p>This data set is a list containing the response (<code>$y</code>),
the exposure history (<code>$exposure</code>), the modifier
(<code>$modifier</code>), and covariates (<code>$z</code>). Now fit the
DLIM using the <code>dlim</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlim_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dlim.html">dlim</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ex_data</span><span class="op">$</span><span class="va">y</span>, </span>
<span>                 x <span class="op">=</span> <span class="va">ex_data</span><span class="op">$</span><span class="va">exposure</span>, </span>
<span>                 modifier <span class="op">=</span> <span class="va">ex_data</span><span class="op">$</span><span class="va">modifier</span>, </span>
<span>                 z <span class="op">=</span> <span class="va">ex_data</span><span class="op">$</span><span class="va">z</span>, </span>
<span>                 df_m <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                 df_l <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                 method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span></code></pre></div>
<p>Note specifying <code>method = "REML</code> along with penalization.
We can quickly look at the object by printing it:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlim_fit</span></span>
<span><span class="co">#&gt; Object of class dlim </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; dlim(y = ex_data$y, x = ex_data$exposure, modifiers = ex_data$modifier, </span></span>
<span><span class="co">#&gt;     z = ex_data$z, df_m = 10, df_l = 10, method = "REML")</span></span>
<span><span class="co">#&gt; Modifier basis degrees of freedom: 10 </span></span>
<span><span class="co">#&gt; Exposure time basis degrees of freedom: 10 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Number of exposure time points: 37 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Penalization: Yes </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; n = 1000</span></span></code></pre></div>
<p>This tells us the GAM was fit using the Gaussian family and identity
link function, there are 10 degrees of freedom for both bases, the
number of exposure time points is 37, and the model was fit using
penalization.</p>
<p>To see predicted cumulative or point-wise effects, we can use the
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function. Specify <code>type="CE"</code> to
obtain cumulative effect estimates, <code>type="DLF"</code> to obtain
point-wise effect estimates, or <code>type=c("CE","DLF")</code> to
obtain both. The order does not matter. The following gives cumulative
effect estimates for a modifier value of 0.5, along with upper and lower
confidence intervals:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlim_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dlim_fit</span>, </span>
<span>                     newdata <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                     type<span class="op">=</span><span class="st">"CE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cumul_betas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dlim_pred</span><span class="op">$</span><span class="va">est_dlim</span><span class="op">$</span><span class="va">betas_cumul</span><span class="op">)</span>,</span>
<span>           LB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dlim_pred</span><span class="op">$</span><span class="va">est_dlim</span><span class="op">$</span><span class="va">cumul_LB</span><span class="op">)</span>,</span>
<span>           UB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dlim_pred</span><span class="op">$</span><span class="va">est_dlim</span><span class="op">$</span><span class="va">cumul_UB</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   cumul_betas       LB       UB</span></span>
<span><span class="co">#&gt; 1    2.521887 2.465761 2.578014</span></span></code></pre></div>
<p>The following gives point-wise effect estimates for a modifier value
of 0.5, along with upper and lower confidence intervals:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlim_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dlim_fit</span>, </span>
<span>                     newdata <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                     type<span class="op">=</span><span class="st">"DLF"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>betas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dlim_pred</span><span class="op">$</span><span class="va">est_dlim</span><span class="op">$</span><span class="va">betas</span><span class="op">)</span>,</span>
<span>           LB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dlim_pred</span><span class="op">$</span><span class="va">est_dlim</span><span class="op">$</span><span class="va">LB</span><span class="op">)</span>,</span>
<span>           UB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dlim_pred</span><span class="op">$</span><span class="va">est_dlim</span><span class="op">$</span><span class="va">UB</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          betas            LB         UB</span></span>
<span><span class="co">#&gt; 1  0.015493436 -0.0088212123 0.03980809</span></span>
<span><span class="co">#&gt; 2  0.012681762 -0.0038701390 0.02923366</span></span>
<span><span class="co">#&gt; 3  0.009452520 -0.0034498292 0.02235487</span></span>
<span><span class="co">#&gt; 4  0.006252764 -0.0055033865 0.01800891</span></span>
<span><span class="co">#&gt; 5  0.003529548 -0.0090522753 0.01611137</span></span>
<span><span class="co">#&gt; 6  0.001729924 -0.0119363763 0.01539622</span></span>
<span><span class="co">#&gt; 7  0.001305969 -0.0117704259 0.01438236</span></span>
<span><span class="co">#&gt; 8  0.002738391 -0.0086632348 0.01414002</span></span>
<span><span class="co">#&gt; 9  0.006518027 -0.0042045510 0.01724061</span></span>
<span><span class="co">#&gt; 10 0.013135728  0.0012408808 0.02503058</span></span>
<span><span class="co">#&gt; 11 0.023082344  0.0098801793 0.03628451</span></span>
<span><span class="co">#&gt; 12 0.036766674  0.0240577371 0.04947561</span></span>
<span><span class="co">#&gt; 13 0.053832923  0.0429503442 0.06471550</span></span>
<span><span class="co">#&gt; 14 0.073509141  0.0636647488 0.08335353</span></span>
<span><span class="co">#&gt; 15 0.095019208  0.0842061010 0.10583231</span></span>
<span><span class="co">#&gt; 16 0.117587005  0.1053237412 0.12985027</span></span>
<span><span class="co">#&gt; 17 0.140398284  0.1282795013 0.15251707</span></span>
<span><span class="co">#&gt; 18 0.162011780  0.1515156855 0.17250787</span></span>
<span><span class="co">#&gt; 19 0.180472918  0.1710107331 0.18993510</span></span>
<span><span class="co">#&gt; 20 0.193812020  0.1833817000 0.20424234</span></span>
<span><span class="co">#&gt; 21 0.200059408  0.1879785198 0.21214030</span></span>
<span><span class="co">#&gt; 22 0.197301455  0.1849772032 0.20962571</span></span>
<span><span class="co">#&gt; 23 0.185529686  0.1745899300 0.19646944</span></span>
<span><span class="co">#&gt; 24 0.167062793  0.1572475206 0.17687807</span></span>
<span><span class="co">#&gt; 25 0.144360981  0.1338786290 0.15484333</span></span>
<span><span class="co">#&gt; 26 0.119884457  0.1078931310 0.13187578</span></span>
<span><span class="co">#&gt; 27 0.096085930  0.0837886022 0.10838326</span></span>
<span><span class="co">#&gt; 28 0.074669984  0.0637996782 0.08554029</span></span>
<span><span class="co">#&gt; 29 0.055966672  0.0463572346 0.06557611</span></span>
<span><span class="co">#&gt; 30 0.040158546  0.0298310819 0.05048601</span></span>
<span><span class="co">#&gt; 31 0.027428157  0.0152862404 0.03957007</span></span>
<span><span class="co">#&gt; 32 0.017957869  0.0049832833 0.03093246</span></span>
<span><span class="co">#&gt; 33 0.011768375 -0.0005820517 0.02411880</span></span>
<span><span class="co">#&gt; 34 0.008423399 -0.0036475010 0.02049430</span></span>
<span><span class="co">#&gt; 35 0.007406503 -0.0059269186 0.02073992</span></span>
<span><span class="co">#&gt; 36 0.008201245 -0.0082854634 0.02468795</span></span>
<span><span class="co">#&gt; 37 0.010291185 -0.0133044965 0.03388687</span></span></code></pre></div>
<p>We can also create plots for the cumulative effects and point-wise
effects. The following plots the estimated cumulative effects over a
grid of modifier values:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_cumulative.html">plot_cumulative</a></span><span class="op">(</span>new_modifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span><span class="op">)</span>, </span>
<span>                mod_fit <span class="op">=</span> <span class="va">dlim_fit</span>, </span>
<span>                mod_name <span class="op">=</span> <span class="st">"modifier"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dlimOverview_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>There are two ways to look at estimated point-wise effects: by
modifier or by time. To create a grid of estimated point-wise effect
plots for a select number of time points, specify
<code>plot_by = time</code> and provide select time points to
<code>time_pts</code>. The following plots estimated point-wise effects
across a grid of modifiers isolated for weeks 10, 20, and 30:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_DLF.html">plot_DLF</a></span><span class="op">(</span>new_modifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span><span class="op">)</span>, </span>
<span>         mod_fit <span class="op">=</span> <span class="va">dlim_fit</span>, </span>
<span>         mod_name <span class="op">=</span> <span class="st">"modifier"</span>, </span>
<span>         plot_by <span class="op">=</span> <span class="st">"time"</span>, </span>
<span>         time_pts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="dlimOverview_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>To create a grid of estimated point-wise effect plots for a select
number of modifier values, specify <code>plot_by = modifier</code> and
provide select modifier values to <code>new_modifiers</code>. The
following plots estimated point-wise effects across all time points
isolated for modifier values 0.25, 0.5, and 0.75:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_DLF.html">plot_DLF</a></span><span class="op">(</span>new_modifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>         mod_fit <span class="op">=</span> <span class="va">dlim_fit</span>, </span>
<span>         mod_name <span class="op">=</span> <span class="st">"modifier"</span>, </span>
<span>         plot_by <span class="op">=</span> <span class="st">"modifier"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dlimOverview_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We can compare this model to a standard DLM using the
<code>model_comparison</code> function. The full model is
<code>dlim_fit</code> model object, and the null model by default is
<code>"DLM"</code>. Then specify the exposure used to create
<code>dlim_fit</code> and the number of bootstrap samples,
<code>B = 5</code> (we recommend using at least 1000 bootstrap samples,
but use 5 to illustrate quickly). The function returns the decision to
reject or fail to reject the null model based on the default confidence
level <code>conf.level</code> of 0.95.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/model_comparison.html">model_comparison</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">dlim_fit</span>, </span>
<span>                 null <span class="op">=</span> <span class="st">"DLM"</span>,</span>
<span>                 x <span class="op">=</span> <span class="va">exposure</span>, </span>
<span>                 B <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      95% </span></span>
<span><span class="co">#&gt; "reject"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="changes-to-package">Changes to package<a class="anchor" aria-label="anchor" href="#changes-to-package"></a>
</h2>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<p>Demateis, D., Keller, K. P., Rojas-Rueda, D., Kioumourtzoglou, M.-A.,
&amp; Wilson, A. (2024). Penalized distributed lag interaction model:
Air pollution, birth weight, and neighborhood vulnerability.
Environmetrics, e2843. <a href="https://doi.org/10.1002/env.2843" class="external-link">https://doi.org/10.1002/env.2843</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Danielle Demateis, Kayleigh Keller, Ander Wilson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
